from django.core.management.base import BaseCommand
from django.db import transaction
from references.models import SimpleReference, SubjectReference

class Command(BaseCommand):
    help = '–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Å—Ç—ã—Ö —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏'

    def add_arguments(self, parser):
        parser.add_argument(
            '--force',
            action='store_true',
            help='–ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏'
        )

    def handle(self, *args, **options):
        force = options.get('force', False)
        
        with transaction.atomic():
            self.stdout.write(self.style.SUCCESS('üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Å—Ç—ã—Ö —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤...'))
            
            created_count = 0
            created_count += self.create_simple_references(force)
            created_count += self.create_subject_references(force)

        self.stdout.write(
            self.style.SUCCESS(f'‚úÖ –ì–æ—Ç–æ–≤–æ! –°–æ–∑–¥–∞–Ω–æ {created_count} —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤.')
        )

    def create_simple_references(self, force=False):
        """–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç—ã—Ö —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤"""
        self.stdout.write('  üìù –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç—ã—Ö —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤...')
        
        references_data = [
            # –¢–∏–ø—ã –∑–∞–¥–∞–Ω–∏–π
            ('task_types', '''–†–∞—Å—á—ë—Ç–Ω–∞—è –∑–∞–¥–∞—á–∞
–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞
–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π –≤–æ–ø—Ä–æ—Å
–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ
–¢–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ
–¢–≤–æ—Ä—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ
–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ
–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ'''),
            
            # –£—Ä–æ–≤–Ω–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
            ('difficulty_levels', '''–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç–µ–ª—å–Ω—ã–π
–ë–∞–∑–æ–≤—ã–π
–ü–æ–≤—ã—à–µ–Ω–Ω—ã–π
–í—ã—Å–æ–∫–∏–π
–≠–∫—Å–ø–µ—Ä—Ç–Ω—ã–π'''),
            
            # –ö–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ (–ø–æ –ë–ª—É–º—É)
            ('cognitive_levels', '''–ó–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ
–ü–æ–Ω–∏–º–∞–Ω–∏–µ
–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
–ê–Ω–∞–ª–∏–∑
–û—Ü–µ–Ω–∫–∞
–°–æ–∑–¥–∞–Ω–∏–µ'''),
            
            # –¢–∏–ø—ã —Ä–∞–±–æ—Ç
            ('work_types', '''–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞
–°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞
–≠–∫–∑–∞–º–µ–Ω
–î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞
–î–æ–º–∞—à–Ω—è—è —Ä–∞–±–æ—Ç–∞
–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞
–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞
–ü—Ä–æ–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞
–ó–∞—á—ë—Ç
–û–ª–∏–º–ø–∏–∞–¥–∞'''),
            
            # –ü—Ä–µ–¥–º–µ—Ç—ã
            ('subjects', '''–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞
–ê–ª–≥–µ–±—Ä–∞
–ì–µ–æ–º–µ—Ç—Ä–∏—è
–§–∏–∑–∏–∫–∞
–•–∏–º–∏—è
–†—É—Å—Å–∫–∏–π —è–∑—ã–∫
–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞
–ò—Å—Ç–æ—Ä–∏—è
–û–±—â–µ—Å—Ç–≤–æ–∑–Ω–∞–Ω–∏–µ
–ë–∏–æ–ª–æ–≥–∏—è
–ì–µ–æ–≥—Ä–∞—Ñ–∏—è
–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫
–ù–µ–º–µ—Ü–∫–∏–π —è–∑—ã–∫
–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π —è–∑—ã–∫
–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞
–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è
–§–∏–∑–∏—á–µ—Å–∫–∞—è –∫—É–ª—å—Ç—É—Ä–∞
–û–ë–ñ
–ê—Å—Ç—Ä–æ–Ω–æ–º–∏—è'''),
            
            # –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
            ('comment_categories', '''–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞
–•–æ—Ä–æ—à–∞—è —Ä–∞–±–æ—Ç–∞
–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ
–¢—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è
–¢–∏–ø–∏—á–Ω–∞—è –æ—à–∏–±–∫–∞
–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è
–ü–æ—Ö–≤–∞–ª–∞
–ó–∞–º–µ—á–∞–Ω–∏–µ
–í–Ω–∏–º–∞–Ω–∏–µ –∫ –¥–µ—Ç–∞–ª—è–º
–¢–≤–æ—Ä—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥'''),
        ]
        
        created_count = 0
        
        for category, items_text in references_data:
            if force:
                # –£–¥–∞–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø—Ä–∏ --force
                SimpleReference.objects.filter(category=category).delete()
            
            obj, created = SimpleReference.objects.get_or_create(
                category=category,
                defaults={
                    'items_text': items_text,
                    'is_active': True
                }
            )
            
            if created:
                created_count += 1
                items_count = len(obj.get_items_list())
                self.stdout.write(f'    ‚úÖ {obj.get_category_display()}: {items_count} —ç–ª–µ–º–µ–Ω—Ç–æ–≤')
            elif force:
                # –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—Ä–∏ --force
                obj.items_text = items_text
                obj.save()
                items_count = len(obj.get_items_list())
                self.stdout.write(f'    üîÑ {obj.get_category_display()}: –æ–±–Ω–æ–≤–ª–µ–Ω–æ, {items_count} —ç–ª–µ–º–µ–Ω—Ç–æ–≤')
            else:
                self.stdout.write(f'    ‚ö†Ô∏è  {obj.get_category_display()}: —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç')
        
        return created_count

    def create_subject_references(self, force=False):
        """–°–æ–∑–¥–∞–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ –∫–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –ø–æ –ø—Ä–µ–¥–º–µ—Ç–∞–º"""
        self.stdout.write('  üìö –°–æ–∑–¥–∞–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ –∫–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞...')
        
        # –≠–ª–µ–º–µ–Ω—Ç—ã —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è –¥–ª—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏
        math_content = '''1.1|–ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–µ —á–∏—Å–ª–∞
1.2|–î—Ä–æ–±–∏
1.3|–†–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —á–∏—Å–ª–∞
1.4|–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ —á–∏—Å–ª–∞
1.5|–ò–∑–º–µ—Ä–µ–Ω–∏—è, –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏—è, –æ—Ü–µ–Ω–∫–∏
2.1|–ë—É–∫–≤–µ–Ω–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
2.2|–ú–Ω–æ–≥–æ—á–ª–µ–Ω—ã
2.3|–ê–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–∏–µ –¥—Ä–æ–±–∏
2.4|–°—Ç–µ–ø–µ–Ω—å —Å —Ü–µ–ª—ã–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–º
3.1|–£—Ä–∞–≤–Ω–µ–Ω–∏—è
3.2|–ù–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞
3.3|–°–∏—Å—Ç–µ–º—ã —É—Ä–∞–≤–Ω–µ–Ω–∏–π
3.4|–°–∏—Å—Ç–µ–º—ã –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤
4.1|–ü–æ–Ω—è—Ç–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
4.2|–ê—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—è
4.3|–ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—è
5.1|–ü–æ–Ω—è—Ç–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
5.2|–°–≤–æ–π—Å—Ç–≤–∞ —Ñ—É–Ω–∫—Ü–∏–π
5.3|–õ–∏–Ω–µ–π–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
5.4|–ö–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
5.5|–°—Ç–µ–ø–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è'''

        # –≠–ª–µ–º–µ–Ω—Ç—ã —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –¥–ª—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏
        math_requirements = '''1.1|–ü–æ–Ω—è—Ç–∏–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞
1.2|–ü–æ–Ω—è—Ç–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞
1.3|–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–æ—Ä–º—É–ª—ã –∏ –º–æ–¥–µ–ª–∏
2.1|–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π
2.2|–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∞–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–∏—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π
2.3|–†–µ—à–µ–Ω–∏–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–π –∏ –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤
2.4|–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π
2.5|–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π —Å –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–º–∏ —Ñ–∏–≥—É—Ä–∞–º–∏
2.6|–ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤
3.1|–ê–Ω–∞–ª–∏–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö —á–∏—Å–ª–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
3.2|–†–µ—à–µ–Ω–∏–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á
3.3|–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤'''

        # –≠–ª–µ–º–µ–Ω—Ç—ã —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è –¥–ª—è —Ñ–∏–∑–∏–∫–∏
        physics_content = '''1.1|–ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ
1.2|–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Ç–µ–ª
1.3|–ó–∞–∫–æ–Ω—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
1.4|–ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏–µ –∫–æ–ª–µ–±–∞–Ω–∏—è –∏ –≤–æ–ª–Ω—ã
2.1|–¢–µ–ø–ª–æ–≤—ã–µ —è–≤–ª–µ–Ω–∏—è
2.2|–ò–∑–º–µ–Ω–µ–Ω–∏—è –∞–≥—Ä–µ–≥–∞—Ç–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π
2.3|–¢–µ–ø–ª–æ–≤—ã–µ –¥–≤–∏–≥–∞—Ç–µ–ª–∏
3.1|–≠–ª–µ–∫—Ç—Ä–∏–∑–∞—Ü–∏—è —Ç–µ–ª
3.2|–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π —Ç–æ–∫
3.3|–ú–∞–≥–Ω–∏—Ç–Ω—ã–µ —è–≤–ª–µ–Ω–∏—è
3.4|–≠–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω–∞—è –∏–Ω–¥—É–∫—Ü–∏—è
3.5|–≠–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω—ã–µ –∫–æ–ª–µ–±–∞–Ω–∏—è –∏ –≤–æ–ª–Ω—ã
4.1|–†–∞–¥–∏–æ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
4.2|–°—Ç—Ä–æ–µ–Ω–∏–µ –∞—Ç–æ–º–∞
4.3|–Ø–¥–µ—Ä–Ω—ã–µ —Ä–µ–∞–∫—Ü–∏–∏'''

        subject_references_data = [
            # –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞
            ('mathematics', 'content_elements', math_content),
            ('mathematics', 'requirement_elements', math_requirements),
            
            # –§–∏–∑–∏–∫–∞  
            ('physics', 'content_elements', physics_content),
            ('physics', 'requirement_elements', '''1.1|–ü–æ–Ω–∏–º–∞–Ω–∏–µ —Å–º—ã—Å–ª–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –ø–æ–Ω—è—Ç–∏–π
1.2|–ü–æ–Ω–∏–º–∞–Ω–∏–µ —Å–º—ã—Å–ª–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –∑–∞–∫–æ–Ω–æ–≤
1.3|–ü–æ–Ω–∏–º–∞–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏–±–æ—Ä–æ–≤
2.1|–û–ø–∏—Å–∞–Ω–∏–µ –∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö —è–≤–ª–µ–Ω–∏–π
2.2|–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏–∑–º–µ—Ä–µ–Ω–∏–π
2.3|–†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á –Ω–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∑–∞–∫–æ–Ω–æ–≤
2.4|–ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç—ã—Ö —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –æ–ø—ã—Ç–æ–≤'''),
            
            # –ê–ª–≥–µ–±—Ä–∞ (—É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç)
            ('algebra', 'content_elements', '''1.1|–ß–∏—Å–ª–∞ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
2.1|–ê–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
2.2|–ú–Ω–æ–≥–æ—á–ª–µ–Ω—ã –∏ –∏—Ö —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ
3.1|–£—Ä–∞–≤–Ω–µ–Ω–∏—è –∏ –∏—Ö —Å–∏—Å—Ç–µ–º—ã
3.2|–ù–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ –∏ –∏—Ö —Å–∏—Å—Ç–µ–º—ã
4.1|–ß–∏—Å–ª–æ–≤—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
5.1|–§—É–Ω–∫—Ü–∏–∏ –∏ –∏—Ö —Å–≤–æ–π—Å—Ç–≤–∞'''),
            
            # –ì–µ–æ–º–µ—Ç—Ä–∏—è
            ('geometry', 'content_elements', '''6.1|–ù–∞—á–∞–ª—å–Ω—ã–µ –ø–æ–Ω—è—Ç–∏—è –≥–µ–æ–º–µ—Ç—Ä–∏–∏
6.2|–¢—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫
6.3|–ß–µ—Ç—ã—Ä—ë—Ö—É–≥–æ–ª—å–Ω–∏–∫–∏
6.4|–ú–Ω–æ–≥–æ—É–≥–æ–ª—å–Ω–∏–∫–∏
6.5|–û–∫—Ä—É–∂–Ω–æ—Å—Ç—å –∏ –∫—Ä—É–≥
6.6|–ò–∑–º–µ—Ä–µ–Ω–∏–µ –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏—Ö –≤–µ–ª–∏—á–∏–Ω
7.1|–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏ –≤–µ–∫—Ç–æ—Ä—ã
8.1|–¢–µ–ª–∞ –∏ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ'''),
        ]
        
        created_count = 0
        
        for subject, category, items_text in subject_references_data:
            if force:
                SubjectReference.objects.filter(subject=subject, category=category).delete()
            
            obj, created = SubjectReference.objects.get_or_create(
                subject=subject,
                category=category,
                defaults={
                    'items_text': items_text,
                    'is_active': True
                }
            )
            
            if created:
                created_count += 1
                items_count = len(obj.get_items_dict())
                self.stdout.write(f'    ‚úÖ {obj.get_subject_display()} - {obj.get_category_display()}: {items_count} —ç–ª–µ–º–µ–Ω—Ç–æ–≤')
            elif force:
                obj.items_text = items_text
                obj.save()
                items_count = len(obj.get_items_dict())
                self.stdout.write(f'    üîÑ {obj.get_subject_display()} - {obj.get_category_display()}: –æ–±–Ω–æ–≤–ª–µ–Ω–æ')
            else:
                self.stdout.write(f'    ‚ö†Ô∏è  {obj.get_subject_display()} - {obj.get_category_display()}: —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç')
        
        return created_count
